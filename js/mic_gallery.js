var gallery_main=function(e){var i={settings:{preload:!1,slideDuration:500,layoutDuration:750,gallery_thumbnailsPerRow:2,gallery_mainSide:"right"},$window:null,$body:null,$gallery_main:null,$gallery_thumbnails:null,$viewer:null,$toggle:null,$navNext:null,$navPrevious:null,slides:[],current:null,locked:!1,keys:{27:function(){i.toggle()},38:function(){i.up()},40:function(){i.down()},32:function(){i.next()},39:function(){i.next()},37:function(){i.previous()}},initProperties:function(){i.$window=e(window),i.$body=e("body"),i.$gallery_thumbnails=e("#gallery_thumbnails"),i.$viewer=e('<div id="viewer"><div class="inner"><div class="nav-next"></div><div class="nav-previous"></div><div class="toggle"></div></div></div>').appendTo(i.$body),i.$navNext=i.$viewer.find(".nav-next"),i.$navPrevious=i.$viewer.find(".nav-previous"),i.$gallery_main=e("#gallery_main"),e('<div class="toggle"></div>').appendTo(i.$gallery_main),i.$toggle=e(".toggle"),skel.vars.IEVersion<9&&i.$window.on("resize",function(){window.setTimeout(function(){i.$viewer.css("width",i.$window.width()-i.$gallery_main.width())},100)}).trigger("resize")},initEvents:function(){var e;i.$window.on("load",function(){i.$body.removeClass("is-loading-0"),window.setTimeout(function(){i.$body.removeClass("is-loading-1")},100),window.setTimeout(function(){i.$body.removeClass("is-loading-2")},100+Math.max(i.settings.layoutDuration-150,0))}),i.$window.on("resize",function(){i.$body.addClass("is-loading-0"),window.clearTimeout(e),e=window.setTimeout(function(){i.$body.removeClass("is-loading-0")},100)}),i.$viewer.on("touchend",function(){skel.breakpoint("medium").active&&i.hide()}),i.$viewer.on("touchstart",function(e){i.$viewer.touchPosX=e.originalEvent.touches[0].pageX,i.$viewer.touchPosY=e.originalEvent.touches[0].pageY}).on("touchmove",function(e){if(null!==i.$viewer.touchPosX&&null!==i.$viewer.touchPosY){var n=i.$viewer.touchPosX-e.originalEvent.touches[0].pageX,l=i.$viewer.touchPosY-e.originalEvent.touches[0].pageY;boundary=20,delta=50,l<boundary&&l>-1*boundary&&n>delta?i.next():l<boundary&&l>-1*boundary&&n<-1*delta&&i.previous();var o=i.$viewer.outerHeight(),t=i.$viewer.get(0).scrollHeight-i.$viewer.scrollTop();(i.$viewer.scrollTop()<=0&&l<0||t>o-2&&t<o+2&&l>0)&&(e.preventDefault(),e.stopPropagation())}}),i.$gallery_main.on("touchstart",function(e){skel.breakpoint("xsmall").active||(i.$gallery_main.touchPosX=e.originalEvent.touches[0].pageX,i.$gallery_main.touchPosY=e.originalEvent.touches[0].pageY)}).on("touchmove",function(e){if(!skel.breakpoint("xsmall").active&&null!==i.$gallery_main.touchPosX&&null!==i.$gallery_main.touchPosY){var n=i.$gallery_main.touchPosX-e.originalEvent.touches[0].pageX,l=i.$gallery_main.touchPosY-e.originalEvent.touches[0].pageY;switch(boundary=20,delta=50,result=!1,i.settings.gallery_mainSide){case"left":result=l<boundary&&l>-1*boundary&&n>delta;break;case"right":result=l<boundary&&l>-1*boundary&&n<-1*delta}result&&i.hide();var o=i.$gallery_main.outerHeight(),t=i.$gallery_main.get(0).scrollHeight-i.$gallery_main.scrollTop();(i.$gallery_main.scrollTop()<=0&&l<0||t>o-2&&t<o+2&&l>0)&&(e.preventDefault(),e.stopPropagation())}}),i.$toggle.on("click",function(){i.toggle()}),i.$toggle.on("touchend",function(e){e.stopPropagation()}),i.$navNext.on("click",function(){i.next()}),i.$navPrevious.on("click",function(){i.previous()}),i.$body.on("keydown","input,select,textarea",function(e){e.stopPropagation()}),i.$window.on("keydown",function(e){skel.breakpoint("xsmall").active||e.keyCode in i.keys&&(e.stopPropagation(),e.preventDefault(),i.keys[e.keyCode]())})},initViewer:function(){i.$gallery_thumbnails.on("click",".thumbnail",function(n){var l=e(this);n.preventDefault(),n.stopPropagation(),i.locked&&l.blur(),i.switchTo(l.data("index"))}),i.$gallery_thumbnails.children().each(function(){var n,l=e(this),o=l.children(".thumbnail");if(n={$parent:l,$slide:null,$slideImage:null,$slideCaption:null,url:o.attr("href"),loaded:!1},l.attr("tabIndex","-1"),n.$slide=e('<div class="slide"><div class="caption"></div><div class="image"></div></div>'),n.$slideImage=n.$slide.children(".image"),n.$slideImage.css("background-image","").css("background-position","center center"),n.$slideCaption=n.$slide.find(".caption"),l.children().not(o).appendTo(n.$slideCaption),i.settings.preload){e('<img src="'+n.url+'" />');n.$slideImage.css("background-image","url("+n.url+")"),n.$slide.addClass("loaded"),n.loaded=!0}i.slides.push(n),o.data("index",i.slides.length-1)})},init:function(){skel.vars.IEVersion<10&&(i.settings.slideDuration=0,i.settings.layoutDuration=0),skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)"}),i.initProperties(),i.initViewer(),i.initEvents(),window.setTimeout(function(){skel.on("-xsmall !xsmall",function(){null===i.current&&i.switchTo(0,!0)})},0)},switchTo:function(n,l){if((i.current!=n||skel.breakpoint("xsmall").active)&&!i.locked){i.locked=!0,!l&&skel.breakpoint("medium").active&&skel.vars.IEVersion>8&&i.hide();var o=null!==i.current?i.slides[i.current]:null,t=i.slides[n];i.current=n,o&&(o.$parent.removeClass("active"),o.$slide.removeClass("active")),t.$parent.addClass("active").focus();var a=function(){o&&o.$slide.detach(),t.$slide.appendTo(i.$viewer),t.loaded?window.setTimeout(function(){t.$slide.addClass("active"),window.setTimeout(function(){i.locked=!1},100)},100):window.setTimeout(function(){t.$slide.addClass("loading"),e('<img src="'+t.url+'" />').on("load",function(){t.$slideImage.css("background-image","url("+t.url+")"),t.loaded=!0,t.$slide.removeClass("loading"),t.$slide.addClass("active"),window.setTimeout(function(){i.locked=!1},100)})},100)};o?window.setTimeout(a,i.settings.slideDuration):a()}},next:function(){var e,n=i.current;e=n>=i.slides.length-1?0:n+1,i.switchTo(e)},previous:function(){var e,n=i.current,l=i.slides.length;e=n<=0?l-1:n-1,i.switchTo(e)},up:function(){if(!i.$body.hasClass("fullscreen")){var e,n=i.current,l=i.slides.length,o=i.settings.gallery_thumbnailsPerRow;e=n<=o-1?l-(o-1-n)-1:n-o,i.switchTo(e)}},down:function(){if(!i.$body.hasClass("fullscreen")){var e,n=i.current,l=i.slides.length,o=i.settings.gallery_thumbnailsPerRow;e=n>=l-o?n-l+o:n+o,i.switchTo(e)}},show:function(){i.$body.hasClass("fullscreen")&&(i.$body.removeClass("fullscreen"),i.$gallery_main.focus())},hide:function(){i.$body.hasClass("fullscreen")||(i.$body.addClass("fullscreen"),i.$gallery_main.blur())},toggle:function(){i.$body.hasClass("fullscreen")?i.show():i.hide()}};return i}(jQuery);gallery_main.init();